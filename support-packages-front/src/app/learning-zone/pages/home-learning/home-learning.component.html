<div class="homeLearn">
  <h1 class="homeLearn__title">The AICCRA Learning Zone</h1>

  <div class="homeLearn__description">
    <p style="font-weight: bold; font-style: italic">
      Resources that help put climate-smart agriculture into practice in Africa
    </p>
    <p>
      The <b>AICCRA Learning Zone is a convenient one-stop shop for</b> analytical resources - case
      studies, training guides, articles and videos - that empower farmers, policymakers and
      communities to make informed decisions in agriculture that work for people, nature and planet.
    </p>
    <p>
      These open-access resources are compiled to promote the broader and deeper adoption of climate
      information services and climate-smart technologies and practices across Africa. It is a
      curated database inspired by the approach used successfully by the CGIAR Research Program on
      Climate Change, Agriculture and Food Security (CCAFS). Visit the
      <a
        class="homeLearn__link"
        href="https://ccafs.cgiar.org/data-management-support-pack"
        target="_blank"
        rel="noopener noreferrer">
        CCAFS Data Management Support Pack.
      </a>
    </p>
    <p>
      The learning zone aims to help select the resource that is most appropriate to your needs
      using a step-by-step filter in an easily accessible, single location for your convenience.
    </p>
    <p>
      Collaboration across AICCRA teams means the tailored selection of readily available resources
      is gathered to meet the needs of AICCRA partners in all the six AICCRA focus countries and
      across the two regions where we work.
    </p>
  </div>

  <div
    class="homeLearn__content"
    *ngIf="!this._servicesVariables.termsConditions && !this._servicesVariables.continue">
    <div class="homeLearn__content__search">
      <div class="homeLearn__content__search--filters">
        <div class="homeLearn__content__search--filters--item">
          <h4>Thematic area</h4>

          <p-dropdown
            [disabled]="disableButton()"
            [options]="thematicAreasData"
            [(ngModel)]="selectedThematicAreas"
            optionLabel="name"
            [filter]="true"
            [style]="{ width: '100%', cursor: disableButton() ? 'not-allowed' : 'pointer' }"
            filterBy="name"
            placeholder="Select a Thematic area"
            (ngModelChange)="filterInformation()">
          </p-dropdown>
        </div>

        <div class="homeLearn__content__search--filters--item">
          <h4>Target user</h4>

          <p-dropdown
            [disabled]="disableButton()"
            [options]="targetUserData"
            [(ngModel)]="selectedTargetUser"
            optionLabel="name"
            [style]="{ width: '100%' }"
            (ngModelChange)="filterInformation()"
            filterBy="name"
            placeholder="Select a Target user">
          </p-dropdown>
        </div>

        <div class="homeLearn__content__search--filters--item">
          <h4>Project phase</h4>

          <p-dropdown
            [disabled]="disableButton()"
            [options]="projectPhaseData"
            [(ngModel)]="selectedProjectUser"
            [style]="{ width: '100%' }"
            optionLabel="name"
            filterBy="name"
            (ngModelChange)="filterInformation()"
            placeholder="Select a Project phase">
          </p-dropdown>
        </div>
      </div>
    </div>

    <div style="padding: 0 2rem">
      <div
        class="homeLearn__content__notFilter"
        *ngIf="!selectedThematicAreas || !selectedTargetUser || !selectedProjectUser">
        <h3>Please use the three filters above to identify useful tools</h3>
        <div class="homeLearn__content__notFilter--images">
          <img
            src="../../../../assets/svg/icon-person-2.svg"
            alt="Person icon"
            [ngStyle]="{ opacity: selectedThematicAreas ? '1' : '0.6' }" />
          <img
            src="../../../../assets/svg/icon-clock-2.svg"
            alt="Clock icon"
            class="checkIcon"
            [ngStyle]="{ opacity: selectedTargetUser ? '1' : '0.6' }" />
          <img
            src="../../../../assets/svg/icon-bookmark-2.svg"
            alt="Interrogation symbol icon"
            class="checkIcon"
            [ngStyle]="{ opacity: selectedProjectUser ? '1' : '0.6' }" />
        </div>
        <p class="homeLearn__content__notFilter--note">
          <b> NOTE: </b>
          We welcome the submission of AICCRA tools to be included in this Tools Support Pack.
          <a routerLink="/aiccra/form-request" class="homeLearn__content__notFilter--note--link">
            Go to submission form.
          </a>
        </p>
      </div>

      <ng-container
        *ngIf="this.selectedThematicAreas && this.selectedTargetUser && this.selectedProjectUser">
        <div class="homeLearn__content__header">
          <div class="homeLearn__content__header--titleContainer">
            <lucide-icon
              name="bolt"
              class="bolt"
              [size]="20"
              style="display: flex; align-items: center; justify-content: center"></lucide-icon>
            <h2 class="homeLearn__content__header--title">Recommended tools</h2>
          </div>
          <p class="homeLearn__content__header--subtitle">Expand the tool to see its details.</p>
        </div>

        <p-table [value]="productsData" [(selection)]="selectedProducts" dataKey="code">
          <ng-template pTemplate="body" let-product let-expanded="expanded">
            <tr>
              <td style="width: 80px; height: 80px">
                <button
                  type="button"
                  pButton
                  pRipple
                  [pRowToggler]="product"
                  class="p-button-text p-button-rounded p-button-plain"
                  [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></button>
              </td>

              <td>
                <p-tableCheckbox [value]="product"></p-tableCheckbox>
              </td>

              <td style="max-width: 455px; min-width: 450px">{{ product.name }}</td>

              <td style="background-color: #f1f1f1; min-width: 180px">
                <div class="homeLearn__content__table__info">
                  <div
                    class="homeLearn__content__table__info--point numOne"
                    [ngStyle]="{
                      'background-color': getImportanceLevelColor(product.importance_level)
                    }"></div>

                  <div>{{ product.importance_level }}</div>
                </div>
              </td>
            </tr>
          </ng-template>

          <ng-template pTemplate="rowexpansion" let-product>
            <tr>
              <td colspan="4">
                <p class="mb-2">{{ product.description }}</p>
                <p class="mb-2"><b>Time: </b>{{ product.estimated_time }}</p>
                <p class="mb-2"><b>Strengths: </b>{{ product.strengths }}</p>
                <p class="mb-2"><b>Limitations: </b>{{ product.limitations }}</p>
                <p class="mb-2"><b>Target scale: </b>{{ product.target_scale }}</p>
                <p class="mb-2"><b>Participants: </b>{{ product.participants }}</p>
                <p class="mb-2"><b>Methods used: </b>{{ product.methods }}</p>
                <p class="mb-2">
                  <b>Types of input data/information: </b>{{ product.input_types }}
                </p>
                <p class="mb-2"><b>Expected outputs: </b>{{ product.expected_outputs }}</p>
                <p class="mb-2"><b>Human resources: </b>{{ product.human_resources }}</p>
                <p class="mb-2"><b>Key reference person: </b>{{ product.key_references }}</p>

                <h2
                  class="homeLearn__download__content--header--subtitle"
                  style="margin-top: 1rem; margin-bottom: 0.5rem"
                  *ngIf="product.resources.length > 0">
                  Recommended resources
                </h2>

                <div class="resources-list" *ngIf="product.resources.length > 0">
                  <div *ngFor="let resource of product.resources" class="resource">
                    <div class="resource-name">
                      <lucide-icon
                        name="link2"
                        class="link2"
                        [size]="16"
                        style="
                          display: flex;
                          align-items: center;
                          justify-content: center;
                        "></lucide-icon>
                      <a
                        href="{{ resource.source }}"
                        target="_blank"
                        class="d-flex align-items-center">
                        {{ resource.name }}
                      </a>
                    </div>
                    <div class="resource-type">{{ resource.type }}</div>
                  </div>
                </div>
              </td>
            </tr>
          </ng-template>

          <ng-template pTemplate="emptymessage">
            <tr>
              <td colspan="4">No tools found</td>
            </tr>
          </ng-template>
        </p-table>

        <div class="homeLearn__content__table__buttons">
          <button
            pButton
            label="New search"
            class="p-button-secondary"
            (click)="initNewSearch()"
            width="100%"></button>

          <button
            pButton
            *ngIf="selectedProducts?.length > 0"
            label="Access to related resources"
            icon="pi pi-filter-pi-download"
            class="homeLearn__content__table__buttons--item"
            (click)="this._servicesVariables.termsAndConditions()"></button>
        </div>
      </ng-container>
    </div>
  </div>

  <app-terms-conditions
    *ngIf="this._servicesVariables.termsConditions"
    [app_id]="3"
    [tools]="selectedProducts"></app-terms-conditions>

  <div
    *ngIf="!this._servicesVariables.termsConditions && this._servicesVariables.continue"
    class="homeLearn__download">
    <div class="homeLearn__download__buttons">
      <button
        pButton
        type="button"
        (click)="goBackToTable()"
        label="Back"
        class="homeLearn__download__buttons--item"
        [style]="{
          'font-size': '0.875rem',
          padding: '0.65625rem 1.09375rem'
        }"></button>

      <button
        pButton
        *ngIf="this._servicesVariables.continue"
        label="Download"
        (click)="downloadPDF()"
        icon="pi pi-download"
        class="homeLearn__download__buttons--download"
        [style]="{
          'font-size': '0.875rem',
          padding: '0.65625rem 1.09375rem'
        }"></button>
    </div>

    <div class="homeLearn__download__content" #pdfSection id="pdfSection">
      <h2 style="margin-bottom: 0.5rem">Tools selected & related resources</h2>

      <div *ngFor="let product of selectedProducts" class="homeLearn__download__content--item">
        <div class="homeLearn__download__content--header">
          <lucide-icon
            name="bolt"
            class="bolt"
            [size]="20"
            style="display: flex; align-items: center; justify-content: center"></lucide-icon>
          <a
            [href]="product.source"
            target="_blank"
            rel="noopener noreferrer"
            class="homeLearn__download__content--header--title">
            {{ product.name }}
          </a>
        </div>
        <p>{{ product.description }}</p>
        <p><b>Time: </b>{{ product.estimated_time }}</p>
        <p><b>Strengths: </b>{{ product.strengths }}</p>
        <p><b>Limitations: </b>{{ product.limitations }}</p>
        <p><b>Does the tool integrate gender?: </b>{{ product.integrates_gender }}</p>
        <p><b>Target scale: </b>{{ product.target_scale }}</p>
        <p><b>Participants: </b>{{ product.participants }}</p>
        <p><b>Methods used: </b>{{ product.methods }}</p>
        <p><b>Types of input data/information: </b>{{ product.input_types }}</p>
        <p><b>Expected outputs: </b>{{ product.expected_outputs }}</p>
        <p><b>Human resources: </b>{{ product.human_resources }}</p>
        <p><b>Key reference person: </b>{{ product.key_references }}</p>

        <h2
          class="homeLearn__download__content--header--subtitle"
          style="margin-top: 0.5rem"
          *ngIf="product.resources.length > 0">
          Recommended resources
        </h2>

        <div class="resources-list" *ngIf="product.resources.length > 0">
          <div *ngFor="let resource of product.resources" class="resource">
            <div class="resource-name">
              <lucide-icon
                name="link2"
                class="link2"
                [size]="16"
                style="display: flex; align-items: center; justify-content: center"></lucide-icon>
              <a [href]="resource.source" target="_blank" rel="noopener noreferrer">
                {{ resource.name }}
              </a>
            </div>
            <div class="resource-type">{{ resource.type }}</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
